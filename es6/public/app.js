var CityWeather=function(){"use strict";var t=function(t){if(!t.ok)throw Error(t.statusText);return t},e=function(t,e){this.config=t,this.onLoadCallback=e,this.fetchCityWeatherImages=this.fetchCityWeatherImages.bind(this)};e.prototype.fetchCityWeather=function(e){var i=this.config.weather,r=i.key,n=i.url+"?q="+e+"&appid="+r;return fetch(n).then(t).then(function(t){return t.json()})},e.prototype.fetchCityWeatherImages=function(e){var i=this.config.unsplash,r=i.key,n=i.url,s=e.weather[0].description,o=n+"?query="+s+"&client_id="+r;return fetch(o).then(t).then(function(t){return t.json()}).then(function(t){return{term:s,images:t.results}})},e.prototype.load=function(t){this.fetchCityWeather(t).then(this.fetchCityWeatherImages).then(this.onLoadCallback).catch(function(t){console.log("getCityWeather:",t)})};var i=function(t,e,i){var r=this;this.$el=document.querySelector(t),this.$tf=this.$el.querySelector("input"),this.$el.term.value=e,this.$tf.addEventListener("focus",function(){return r.$tf.value=""}),this.$el.addEventListener("submit",this.onSubmit(i))};i.prototype.onSubmit=function(t){var e=this;return function(i){i.preventDefault();var r=e.$el.term.value;r.length&&t(r)}};var r=function(t){Array.from(t.children).forEach(function(e){return t.removeChild(e)})},n=function(t){this.$el=document.querySelector(t),this.display=this.display.bind(this)};n.prototype.update=function(t,e){var i=this;r(this.$el);var n=document.createElement("img");n.addEventListener("load",function(){r(i.$el),i.$el.appendChild(n)}),n.src=t,n.alt=e},n.prototype.display=function(t,e,i){console.log("imageUrl",e),this.update(e,i||t)};var s=function(t,e,i){this.$el=document.querySelector(t),this.utm=e,this.displayMain=i,this.onLinkClick=this.onLinkClick.bind(this)};s.prototype.createThumb=function(t,e,i){var r=document.createElement("img");r.src=e,r.alt=i,r.className="thumbs__thumb",r.addEventListener("load",function(){return t.appendChild(r)})},s.prototype.onLinkClick=function(t){var e=this;return function(i){i.preventDefault(),e.displayMain(t)}},s.prototype.display=function(t,e){var i=this;r(this.$el),e.forEach(function(r,n){var s=r.links.html,o=r.description||t,a=r.urls.thumb,h=document.createElement("a");h.href=s+"?"+i.utm,h.className="thumbs__link",h.addEventListener("click",i.onLinkClick(e[n])),i.createThumb(h,a,o),i.$el.appendChild(h)})};var o=function(t){var e=t.weather,i=t.unsplash;return{weather:{key:e.apiKey,city:e.city,url:"https://api.openweathermap.org/data/2.5/weather"},unsplash:{key:i.apiKey,utm:"utm_source="+i.appName+"&utm_medium=referral&utm_campaign=api-credit",url:"https://api.unsplash.com/search/photos"}}},a=function(t){this.config=o(t);var r=this.config.weather.city,a=this.config.unsplash.utm;this.$els={body:document.querySelector("body"),creditUser:document.querySelector("#credit-user"),creditPlatform:document.querySelector("#credit-platform")},this.loadWeatherImages=this.loadWeatherImages.bind(this),this.onWeatherImagesLoaded=this.onWeatherImagesLoaded.bind(this),this.onThumbClick=this.onThumbClick.bind(this),this.api=new e(this.config,this.onWeatherImagesLoaded),this.photo=new n("#photo"),this.thumbs=new s("#thumbs",a,this.onThumbClick),this.search=new i("#search",r,this.loadWeatherImages),this.initPlatformCredits(a),this.loadWeatherImages(r)};return a.prototype.loadWeatherImages=function(t){this.api.load(t)},a.prototype.onWeatherImagesLoaded=function(t){var e=t.term,i=t.images;this.currentTerm=e,this.thumbs.display(this.currentTerm,i),this.onThumbClick(i[0])},a.prototype.onThumbClick=function(t){var e=t.user,i=t.urls,r=t.color,n=t.description;this.photo.display(this.currentTerm,i.regular,n),this.updateUserCredit(this.currentTerm,e),this.$els.body.style.backgroundColor=r},a.prototype.initPlatformCredits=function(t){this.$els.creditPlatform.href="https://unsplash.com/?"+t},a.prototype.updateUserCredit=function(t,e){this.$els.creditUser.href=e.links.html+"?"+this.utm,this.$els.creditUser.innerText='"'+t+'" by '+e.name},a}();
//# sourceMappingURL=app.js.map
